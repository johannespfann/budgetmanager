\lstnewenvironment{javacode}[2]{
    \lstset{language=java, 
    numberbychapter=true,
   	basicstyle=\tiny, 
   	keywordstyle=\color{blue!80!black!100}, 	 
   	commentstyle=\color{green!50!black!100}, 
   	stringstyle=, 
   	identifierstyle=\color{gray},
   	breaklines=true, 
   	numbers=left,
   	label=#1,
   	caption=#2,
   	numberstyle=\tiny, 
   	frame=single}
   	\begingroup
   	\nopagebreak
   	}
   	{\endgroup}%  	   	